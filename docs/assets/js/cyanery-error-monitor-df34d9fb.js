let et;const un={qq:/\bm?qqbrowser\/([0-9.]+)/,360:a=>a.indexOf("360 aphone browser")!==-1?/\b360 aphone browser \(([^\)]+)\)/:/\b360(?:se|ee|chrome|browser)\b/,aoyou:/\baoyou/,webview:/\bcpu(?: iphone)? os (?:[0-9._]+).+\bapplewebkit\b/,firefox:/\bfirefox\/([0-9.ab]+)/,chrome:/ (?:chrome|crios|crmo)\/([0-9.]+)/,ie:/\b(?:msie |ie |trident\/[0-9].*rv[ :])([0-9.]+)/,android:a=>a.indexOf("android")===-1?"":/\bversion\/([0-9.]+(?: beta)?)/,safari:/\bversion\/([0-9.]+(?: beta)?)(?: mobile(?:\/[a-z0-9]+)?)? safari\//,opera:/\bopera/,unknow:"unknow"},fn={windows:/\bwindows nt ([0-9.]+)/,macosx:/\bmac os x ([0-9._]+)/,linux:"linux",wphone:a=>a.indexOf("windows phone ")!==-1?/\bwindows phone (?:os )?([0-9.]+)/:a.indexOf("xblwp")!==-1?/\bxblwp([0-9.]+)/:a.indexOf("zunewp")!==-1?/\bzunewp([0-9.]+)/:"windows phone",ios:a=>/\bcpu(?: iphone)? os /.test(a)?/\bcpu(?: iphone)? os ([0-9._]+)/:a.indexOf("iph os ")!==-1?/\biph os ([0-9_]+)/:/\bios\b/,android:a=>a.indexOf("android")>=0?/\bandroid[ \/-]?([0-9.x]+)?/:a.indexOf("adr")>=0?a.indexOf("mqqbrowser")>=0?/\badr[ ]\(linux; u; ([0-9.]+)?/:/\badr(?:[ ]([0-9.]+))?/:"android",unknow:"unknow"},dn={weixin:/micromessenger/gi,qqvideo:/qqlivebrowser/gi,qqvideoipad:/qqlivehdbrowser/gi,shouqq:/qq\//gi,qqnews:/qqnews/gi,qzone:/qzone\//gi,unknow:"unknow"},Yt=(a,s)=>Object.prototype.toString.call(a)===`[object ${s}]`,It=(a,s)=>{const d=Y[a.toLowerCase()];for(const h in s){const m=s[h],p=Yt(m,"Function")?m(ut()):m;if(d.name=h,p===!0)break;if(toString(p)==="[object String]"){if(ut().indexOf(p)!==-1)break}else if(Yt(p,"Object")){if(p.version!==void 0){d.version=p.version;break}}else if(p&&p.exec){const I=p.exec(ut());if(I){I.length>=2&&I[1]?d.version=I[1].replace(/_/g,"."):d.version="0.0.0";break}}}return d},ut=()=>{if(!et){const a="__",s=navigator.userAgent||"",d=navigator.platform||"",h=navigator.appVersion||"",m=navigator.vendor||"";et=s+a+d+a+h+a+m,et=et.toLowerCase()}return et},re=a=>(et||(It("os",fn),It("platform",dn),It("browser",un)),a==="all"||a==="full"?ut():a!==void 0?Y[a].name:`${Y.os.name}  _${Y.os.version}  ${Y.browser.name}  _${Y.browser.version}`),Y={os:{name:"unknow",version:"0.0.0"},platform:{name:"unknow",version:"0.0.0"},browser:{name:"unknow",version:"0.0.0"}},oe=(...a)=>{const s=a[0],d=Array.prototype.slice.call(a,1);for(let h=0;h<d.length;h++){const m=d[h];for(const p in m)s[p]=m[p]}return s},Rt=a=>{if(!a||!a.length)return!0;let s=0;for(let d=a.length-1;d>0;d--)a[d]||(s+=1);return s>a.length-1},ln=a=>{const s=new Date(parseInt(a,10));return`${s.getFullYear()}-${s.getMonth()+1<10?`0${s.getMonth()+1}`:s.getMonth()+1}-${s.getDate()} ${s.getHours()}:${s.getMinutes()}:`+s.getSeconds()},ie=a=>{const s="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";a=a||9;let d="";for(let h=0;h<a;h++)d+=s.charAt(Math.floor(Math.random()*s.length));return d};var ct=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/var Zt,xt,G=(Zt=function(a,s){a.exports=function d(h,m,p){function I(D,z){if(!m[D]){if(!h[D]){var y=typeof require=="function"&&require;if(!z&&y)return y(D,!0);if(S)return S(D,!0);var w=new Error("Cannot find module '"+D+"'");throw w.code="MODULE_NOT_FOUND",w}var O=m[D]={exports:{}};h[D][0].call(O.exports,function(k){var P=h[D][1][k];return I(P||k)},O,O.exports,d,h,m,p)}return m[D].exports}for(var S=typeof require=="function"&&require,C=0;C<p.length;C++)I(p[C]);return I}({1:[function(d,h,m){(function(p){var I,S,C=p.MutationObserver||p.WebKitMutationObserver;if(C){var D=0,z=new C(k),y=p.document.createTextNode("");z.observe(y,{characterData:!0}),I=function(){y.data=D=++D%2}}else if(p.setImmediate||p.MessageChannel===void 0)I="document"in p&&"onreadystatechange"in p.document.createElement("script")?function(){var A=p.document.createElement("script");A.onreadystatechange=function(){k(),A.onreadystatechange=null,A.parentNode.removeChild(A),A=null},p.document.documentElement.appendChild(A)}:function(){setTimeout(k,0)};else{var w=new p.MessageChannel;w.port1.onmessage=k,I=function(){w.port2.postMessage(0)}}var O=[];function k(){var A,K;S=!0;for(var T=O.length;T;){for(K=O,O=[],A=-1;++A<T;)K[A]();T=O.length}S=!1}function P(A){O.push(A)!==1||S||I()}h.exports=P}).call(this,ct!==void 0?ct:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],2:[function(d,h,m){var p=d(1);function I(){}var S={},C=["REJECTED"],D=["FULFILLED"],z=["PENDING"];function y(b){if(typeof b!="function")throw new TypeError("resolver must be a function");this.state=z,this.queue=[],this.outcome=void 0,b!==I&&P(this,b)}function w(b,E,x){this.promise=b,typeof E=="function"&&(this.onFulfilled=E,this.callFulfilled=this.otherCallFulfilled),typeof x=="function"&&(this.onRejected=x,this.callRejected=this.otherCallRejected)}function O(b,E,x){p(function(){var N;try{N=E(x)}catch(L){return S.reject(b,L)}N===b?S.reject(b,new TypeError("Cannot resolve promise with itself")):S.resolve(b,N)})}function k(b){var E=b&&b.then;if(b&&(typeof b=="object"||typeof b=="function")&&typeof E=="function")return function(){E.apply(b,arguments)}}function P(b,E){var x=!1;function N(F){x||(x=!0,S.reject(b,F))}function L(F){x||(x=!0,S.resolve(b,F))}function q(){E(L,N)}var M=A(q);M.status==="error"&&N(M.value)}function A(b,E){var x={};try{x.value=b(E),x.status="success"}catch(N){x.status="error",x.value=N}return x}function K(b){return b instanceof this?b:S.resolve(new this(I),b)}function T(b){var E=new this(I);return S.reject(E,b)}function dt(b){var E=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var x=b.length,N=!1;if(!x)return this.resolve([]);for(var L=new Array(x),q=0,M=-1,F=new this(I);++M<x;)U(b[M],M);return F;function U(nt,it){function lt(Z){L[it]=Z,++q!==x||N||(N=!0,S.resolve(F,L))}E.resolve(nt).then(lt,function(Z){N||(N=!0,S.reject(F,Z))})}}function V(b){var E=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var x=b.length,N=!1;if(!x)return this.resolve([]);for(var L=-1,q=new this(I);++L<x;)M(b[L]);return q;function M(F){E.resolve(F).then(function(U){N||(N=!0,S.resolve(q,U))},function(U){N||(N=!0,S.reject(q,U))})}}h.exports=y,y.prototype.catch=function(b){return this.then(null,b)},y.prototype.then=function(b,E){if(typeof b!="function"&&this.state===D||typeof E!="function"&&this.state===C)return this;var x=new this.constructor(I);return this.state!==z?O(x,this.state===D?b:E,this.outcome):this.queue.push(new w(x,b,E)),x},w.prototype.callFulfilled=function(b){S.resolve(this.promise,b)},w.prototype.otherCallFulfilled=function(b){O(this.promise,this.onFulfilled,b)},w.prototype.callRejected=function(b){S.reject(this.promise,b)},w.prototype.otherCallRejected=function(b){O(this.promise,this.onRejected,b)},S.resolve=function(b,E){var x=A(k,E);if(x.status==="error")return S.reject(b,x.value);var N=x.value;if(N)P(b,N);else{b.state=D,b.outcome=E;for(var L=-1,q=b.queue.length;++L<q;)b.queue[L].callFulfilled(E)}return b},S.reject=function(b,E){b.state=C,b.outcome=E;for(var x=-1,N=b.queue.length;++x<N;)b.queue[x].callRejected(E);return b},y.resolve=K,y.reject=T,y.all=dt,y.race=V},{1:1}],3:[function(d,h,m){(function(p){typeof p.Promise!="function"&&(p.Promise=d(2))}).call(this,ct!==void 0?ct:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{2:2}],4:[function(d,h,m){var p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function I(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function S(){try{if(typeof indexedDB!="undefined")return indexedDB;if(typeof webkitIndexedDB!="undefined")return webkitIndexedDB;if(typeof mozIndexedDB!="undefined")return mozIndexedDB;if(typeof OIndexedDB!="undefined")return OIndexedDB;if(typeof msIndexedDB!="undefined")return msIndexedDB}catch{return}}var C=S();function D(){try{if(!C||!C.open)return!1;var t=typeof openDatabase!="undefined"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),e=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!t||e)&&typeof indexedDB!="undefined"&&typeof IDBKeyRange!="undefined"}catch{return!1}}function z(t,e){t=t||[],e=e||{};try{return new Blob(t,e)}catch(r){if(r.name!=="TypeError")throw r;for(var n=new(typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder),o=0;o<t.length;o+=1)n.append(t[o]);return n.getBlob(e.type)}}typeof Promise=="undefined"&&d(3);var y=Promise;function w(t,e){e&&t.then(function(n){e(null,n)},function(n){e(n)})}function O(t,e,n){typeof e=="function"&&t.then(e),typeof n=="function"&&t.catch(n)}function k(t){return typeof t!="string"&&(console.warn(t+" used as a key, but it is not a string."),t=String(t)),t}function P(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var A="local-forage-detect-blob-support",K=void 0,T={},dt=Object.prototype.toString,V="readonly",b="readwrite";function E(t){for(var e=t.length,n=new ArrayBuffer(e),o=new Uint8Array(n),r=0;r<e;r++)o[r]=t.charCodeAt(r);return n}function x(t){return new y(function(e){var n=t.transaction(A,b),o=z([""]);n.objectStore(A).put(o,"key"),n.onabort=function(r){r.preventDefault(),r.stopPropagation(),e(!1)},n.oncomplete=function(){var r=navigator.userAgent.match(/Chrome\/(\d+)/),i=navigator.userAgent.match(/Edge\//);e(i||!r||parseInt(r[1],10)>=43)}}).catch(function(){return!1})}function N(t){return typeof K=="boolean"?y.resolve(K):x(t).then(function(e){return K=e})}function L(t){var e=T[t.name],n={};n.promise=new y(function(o,r){n.resolve=o,n.reject=r}),e.deferredOperations.push(n),e.dbReady?e.dbReady=e.dbReady.then(function(){return n.promise}):e.dbReady=n.promise}function q(t){var e=T[t.name].deferredOperations.pop();if(e)return e.resolve(),e.promise}function M(t,e){var n=T[t.name].deferredOperations.pop();if(n)return n.reject(e),n.promise}function F(t,e){return new y(function(n,o){if(T[t.name]=T[t.name]||Ct(),t.db){if(!e)return n(t.db);L(t),t.db.close()}var r=[t.name];e&&r.push(t.version);var i=C.open.apply(C,r);e&&(i.onupgradeneeded=function(c){var u=i.result;try{u.createObjectStore(t.storeName),c.oldVersion<=1&&u.createObjectStore(A)}catch(f){if(f.name!=="ConstraintError")throw f;console.warn('The database "'+t.name+'" has been upgraded from version '+c.oldVersion+" to version "+c.newVersion+', but the storage "'+t.storeName+'" already exists.')}}),i.onerror=function(c){c.preventDefault(),o(i.error)},i.onsuccess=function(){var c=i.result;c.onversionchange=function(u){u.target.close()},n(c),q(t)}})}function U(t){return F(t,!1)}function nt(t){return F(t,!0)}function it(t,e){if(!t.db)return!0;var n=!t.db.objectStoreNames.contains(t.storeName),o=t.version<t.db.version,r=t.version>t.db.version;if(o&&(t.version!==e&&console.warn('The database "'+t.name+`" can't be downgraded from version `+t.db.version+" to version "+t.version+"."),t.version=t.db.version),r||n){if(n){var i=t.db.version+1;i>t.version&&(t.version=i)}return!0}return!1}function lt(t){return new y(function(e,n){var o=new FileReader;o.onerror=n,o.onloadend=function(r){var i=btoa(r.target.result||"");e({__local_forage_encoded_blob:!0,data:i,type:t.type})},o.readAsBinaryString(t)})}function Z(t){return z([E(atob(t.data))],{type:t.type})}function At(t){return t&&t.__local_forage_encoded_blob}function fe(t){var e=this,n=e._initReady().then(function(){var o=T[e._dbInfo.name];if(o&&o.dbReady)return o.dbReady});return O(n,t,t),n}function de(t){L(t);for(var e=T[t.name],n=e.forages,o=0;o<n.length;o++){var r=n[o];r._dbInfo.db&&(r._dbInfo.db.close(),r._dbInfo.db=null)}return t.db=null,U(t).then(function(i){return t.db=i,it(t)?nt(t):i}).then(function(i){t.db=e.db=i;for(var c=0;c<n.length;c++)n[c]._dbInfo.db=i}).catch(function(i){throw M(t,i),i})}function W(t,e,n,o){o===void 0&&(o=1);try{var r=t.db.transaction(t.storeName,e);n(null,r)}catch(i){if(o>0&&(!t.db||i.name==="InvalidStateError"||i.name==="NotFoundError"))return y.resolve().then(function(){if(!t.db||i.name==="NotFoundError"&&!t.db.objectStoreNames.contains(t.storeName)&&t.version<=t.db.version)return t.db&&(t.version=t.db.version+1),nt(t)}).then(function(){return de(t).then(function(){W(t,e,n,o-1)})}).catch(n);n(i)}}function Ct(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function le(t){var e=this,n={db:null};if(t)for(var o in t)n[o]=t[o];var r=T[n.name];r||(r=Ct(),T[n.name]=r),r.forages.push(e),e._initReady||(e._initReady=e.ready,e.ready=fe);var i=[];function c(){return y.resolve()}for(var u=0;u<r.forages.length;u++){var f=r.forages[u];f!==e&&i.push(f._initReady().catch(c))}var l=r.forages.slice(0);return y.all(i).then(function(){return n.db=r.db,U(n)}).then(function(v){return n.db=v,it(n,e._defaultConfig.version)?nt(n):v}).then(function(v){n.db=r.db=v,e._dbInfo=n;for(var g=0;g<l.length;g++){var _=l[g];_!==e&&(_._dbInfo.db=n.db,_._dbInfo.version=n.version)}})}function he(t,e){var n=this;t=k(t);var o=new y(function(r,i){n.ready().then(function(){W(n._dbInfo,V,function(c,u){if(c)return i(c);try{var f=u.objectStore(n._dbInfo.storeName).get(t);f.onsuccess=function(){var l=f.result;l===void 0&&(l=null),At(l)&&(l=Z(l)),r(l)},f.onerror=function(){i(f.error)}}catch(l){i(l)}})}).catch(i)});return w(o,e),o}function pe(t,e){var n=this,o=new y(function(r,i){n.ready().then(function(){W(n._dbInfo,V,function(c,u){if(c)return i(c);try{var f=u.objectStore(n._dbInfo.storeName).openCursor(),l=1;f.onsuccess=function(){var v=f.result;if(v){var g=v.value;At(g)&&(g=Z(g));var _=t(g,v.key,l++);_!==void 0?r(_):v.continue()}else r()},f.onerror=function(){i(f.error)}}catch(v){i(v)}})}).catch(i)});return w(o,e),o}function ve(t,e,n){var o=this;t=k(t);var r=new y(function(i,c){var u;o.ready().then(function(){return u=o._dbInfo,dt.call(e)==="[object Blob]"?N(u.db).then(function(f){return f?e:lt(e)}):e}).then(function(f){W(o._dbInfo,b,function(l,v){if(l)return c(l);try{var g=v.objectStore(o._dbInfo.storeName);f===null&&(f=void 0);var _=g.put(f,t);v.oncomplete=function(){f===void 0&&(f=null),i(f)},v.onabort=v.onerror=function(){var R=_.error?_.error:_.transaction.error;c(R)}}catch(R){c(R)}})}).catch(c)});return w(r,n),r}function be(t,e){var n=this;t=k(t);var o=new y(function(r,i){n.ready().then(function(){W(n._dbInfo,b,function(c,u){if(c)return i(c);try{var f=u.objectStore(n._dbInfo.storeName).delete(t);u.oncomplete=function(){r()},u.onerror=function(){i(f.error)},u.onabort=function(){var l=f.error?f.error:f.transaction.error;i(l)}}catch(l){i(l)}})}).catch(i)});return w(o,e),o}function ye(t){var e=this,n=new y(function(o,r){e.ready().then(function(){W(e._dbInfo,b,function(i,c){if(i)return r(i);try{var u=c.objectStore(e._dbInfo.storeName).clear();c.oncomplete=function(){o()},c.onabort=c.onerror=function(){var f=u.error?u.error:u.transaction.error;r(f)}}catch(f){r(f)}})}).catch(r)});return w(n,t),n}function me(t){var e=this,n=new y(function(o,r){e.ready().then(function(){W(e._dbInfo,V,function(i,c){if(i)return r(i);try{var u=c.objectStore(e._dbInfo.storeName).count();u.onsuccess=function(){o(u.result)},u.onerror=function(){r(u.error)}}catch(f){r(f)}})}).catch(r)});return w(n,t),n}function ge(t,e){var n=this,o=new y(function(r,i){t<0?r(null):n.ready().then(function(){W(n._dbInfo,V,function(c,u){if(c)return i(c);try{var f=u.objectStore(n._dbInfo.storeName),l=!1,v=f.openKeyCursor();v.onsuccess=function(){var g=v.result;g?t===0||l?r(g.key):(l=!0,g.advance(t)):r(null)},v.onerror=function(){i(v.error)}}catch(g){i(g)}})}).catch(i)});return w(o,e),o}function we(t){var e=this,n=new y(function(o,r){e.ready().then(function(){W(e._dbInfo,V,function(i,c){if(i)return r(i);try{var u=c.objectStore(e._dbInfo.storeName).openKeyCursor(),f=[];u.onsuccess=function(){var l=u.result;l?(f.push(l.key),l.continue()):o(f)},u.onerror=function(){r(u.error)}}catch(l){r(l)}})}).catch(r)});return w(n,t),n}function _e(t,e){e=P.apply(this,arguments);var n=this.config();(t=typeof t!="function"&&t||{}).name||(t.name=t.name||n.name,t.storeName=t.storeName||n.storeName);var o,r=this;if(t.name){var i=t.name===n.name&&r._dbInfo.db?y.resolve(r._dbInfo.db):U(t).then(function(c){var u=T[t.name],f=u.forages;u.db=c;for(var l=0;l<f.length;l++)f[l]._dbInfo.db=c;return c});o=t.storeName?i.then(function(c){if(c.objectStoreNames.contains(t.storeName)){var u=c.version+1;L(t);var f=T[t.name],l=f.forages;c.close();for(var v=0;v<l.length;v++){var g=l[v];g._dbInfo.db=null,g._dbInfo.version=u}var _=new y(function(R,j){var B=C.open(t.name,u);B.onerror=function(H){B.result.close(),j(H)},B.onupgradeneeded=function(){B.result.deleteObjectStore(t.storeName)},B.onsuccess=function(){var H=B.result;H.close(),R(H)}});return _.then(function(R){f.db=R;for(var j=0;j<l.length;j++){var B=l[j];B._dbInfo.db=R,q(B._dbInfo)}}).catch(function(R){throw(M(t,R)||y.resolve()).catch(function(){}),R})}}):i.then(function(c){L(t);var u=T[t.name],f=u.forages;c.close();for(var l=0;l<f.length;l++)f[l]._dbInfo.db=null;var v=new y(function(g,_){var R=C.deleteDatabase(t.name);R.onerror=function(){var j=R.result;j&&j.close(),_(R.error)},R.onblocked=function(){console.warn('dropInstance blocked for database "'+t.name+'" until all open connections are closed')},R.onsuccess=function(){var j=R.result;j&&j.close(),g(j)}});return v.then(function(g){u.db=g;for(var _=0;_<f.length;_++)q(f[_]._dbInfo)}).catch(function(g){throw(M(t,g)||y.resolve()).catch(function(){}),g})})}else o=y.reject("Invalid arguments");return w(o,e),o}var Ie={_driver:"asyncStorage",_initStorage:le,_support:D(),iterate:pe,getItem:he,setItem:ve,removeItem:be,clear:ye,length:me,key:ge,keys:we,dropInstance:_e};function xe(){return typeof openDatabase=="function"}var J="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Se="~~local_forage_type~",Dt=/^~~local_forage_type~([^~]+)~/,at="__lfsc__:",ht=at.length,pt="arbf",vt="blob",Tt="si08",Lt="ui08",Bt="uic8",qt="si16",Mt="si32",Ft="ur16",zt="ui32",Pt="fl32",$t="fl64",Ut=ht+pt.length,Wt=Object.prototype.toString;function Ht(t){var e,n,o,r,i,c=.75*t.length,u=t.length,f=0;t[t.length-1]==="="&&(c--,t[t.length-2]==="="&&c--);var l=new ArrayBuffer(c),v=new Uint8Array(l);for(e=0;e<u;e+=4)n=J.indexOf(t[e]),o=J.indexOf(t[e+1]),r=J.indexOf(t[e+2]),i=J.indexOf(t[e+3]),v[f++]=n<<2|o>>4,v[f++]=(15&o)<<4|r>>2,v[f++]=(3&r)<<6|63&i;return l}function bt(t){var e,n=new Uint8Array(t),o="";for(e=0;e<n.length;e+=3)o+=J[n[e]>>2],o+=J[(3&n[e])<<4|n[e+1]>>4],o+=J[(15&n[e+1])<<2|n[e+2]>>6],o+=J[63&n[e+2]];return n.length%3==2?o=o.substring(0,o.length-1)+"=":n.length%3==1&&(o=o.substring(0,o.length-2)+"=="),o}function Ee(t,e){var n="";if(t&&(n=Wt.call(t)),t&&(n==="[object ArrayBuffer]"||t.buffer&&Wt.call(t.buffer)==="[object ArrayBuffer]")){var o,r=at;t instanceof ArrayBuffer?(o=t,r+=pt):(o=t.buffer,n==="[object Int8Array]"?r+=Tt:n==="[object Uint8Array]"?r+=Lt:n==="[object Uint8ClampedArray]"?r+=Bt:n==="[object Int16Array]"?r+=qt:n==="[object Uint16Array]"?r+=Ft:n==="[object Int32Array]"?r+=Mt:n==="[object Uint32Array]"?r+=zt:n==="[object Float32Array]"?r+=Pt:n==="[object Float64Array]"?r+=$t:e(new Error("Failed to get type for BinaryArray"))),e(r+bt(o))}else if(n==="[object Blob]"){var i=new FileReader;i.onload=function(){var c=Se+t.type+"~"+bt(this.result);e(at+vt+c)},i.readAsArrayBuffer(t)}else try{e(JSON.stringify(t))}catch(c){console.error("Couldn't convert value into a JSON string: ",t),e(null,c)}}function Re(t){if(t.substring(0,ht)!==at)return JSON.parse(t);var e,n=t.substring(Ut),o=t.substring(ht,Ut);if(o===vt&&Dt.test(n)){var r=n.match(Dt);e=r[1],n=n.substring(r[0].length)}var i=Ht(n);switch(o){case pt:return i;case vt:return z([i],{type:e});case Tt:return new Int8Array(i);case Lt:return new Uint8Array(i);case Bt:return new Uint8ClampedArray(i);case qt:return new Int16Array(i);case Ft:return new Uint16Array(i);case Mt:return new Int32Array(i);case zt:return new Uint32Array(i);case Pt:return new Float32Array(i);case $t:return new Float64Array(i);default:throw new Error("Unkown type: "+o)}}var yt={serialize:Ee,deserialize:Re,stringToBuffer:Ht,bufferToString:bt};function Kt(t,e,n,o){t.executeSql("CREATE TABLE IF NOT EXISTS "+e.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,o)}function je(t){var e=this,n={db:null};if(t)for(var o in t)n[o]=typeof t[o]!="string"?t[o].toString():t[o];var r=new y(function(i,c){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(u){return c(u)}n.db.transaction(function(u){Kt(u,n,function(){e._dbInfo=n,i()},function(f,l){c(l)})},c)});return n.serializer=yt,r}function X(t,e,n,o,r,i){t.executeSql(n,o,r,function(c,u){u.code===u.SYNTAX_ERR?c.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[e.storeName],function(f,l){l.rows.length?i(f,u):Kt(f,e,function(){f.executeSql(n,o,r,i)},i)},i):i(c,u)},i)}function Ne(t,e){var n=this;t=k(t);var o=new y(function(r,i){n.ready().then(function(){var c=n._dbInfo;c.db.transaction(function(u){X(u,c,"SELECT * FROM "+c.storeName+" WHERE key = ? LIMIT 1",[t],function(f,l){var v=l.rows.length?l.rows.item(0).value:null;v&&(v=c.serializer.deserialize(v)),r(v)},function(f,l){i(l)})})}).catch(i)});return w(o,e),o}function Oe(t,e){var n=this,o=new y(function(r,i){n.ready().then(function(){var c=n._dbInfo;c.db.transaction(function(u){X(u,c,"SELECT * FROM "+c.storeName,[],function(f,l){for(var v=l.rows,g=v.length,_=0;_<g;_++){var R=v.item(_),j=R.value;if(j&&(j=c.serializer.deserialize(j)),(j=t(j,R.key,_+1))!==void 0)return void r(j)}r()},function(f,l){i(l)})})}).catch(i)});return w(o,e),o}function Jt(t,e,n,o){var r=this;t=k(t);var i=new y(function(c,u){r.ready().then(function(){e===void 0&&(e=null);var f=e,l=r._dbInfo;l.serializer.serialize(e,function(v,g){g?u(g):l.db.transaction(function(_){X(_,l,"INSERT OR REPLACE INTO "+l.storeName+" (key, value) VALUES (?, ?)",[t,v],function(){c(f)},function(R,j){u(j)})},function(_){if(_.code===_.QUOTA_ERR){if(o>0)return void c(Jt.apply(r,[t,f,n,o-1]));u(_)}})})}).catch(u)});return w(i,n),i}function ke(t,e,n){return Jt.apply(this,[t,e,n,1])}function Ae(t,e){var n=this;t=k(t);var o=new y(function(r,i){n.ready().then(function(){var c=n._dbInfo;c.db.transaction(function(u){X(u,c,"DELETE FROM "+c.storeName+" WHERE key = ?",[t],function(){r()},function(f,l){i(l)})})}).catch(i)});return w(o,e),o}function Ce(t){var e=this,n=new y(function(o,r){e.ready().then(function(){var i=e._dbInfo;i.db.transaction(function(c){X(c,i,"DELETE FROM "+i.storeName,[],function(){o()},function(u,f){r(f)})})}).catch(r)});return w(n,t),n}function De(t){var e=this,n=new y(function(o,r){e.ready().then(function(){var i=e._dbInfo;i.db.transaction(function(c){X(c,i,"SELECT COUNT(key) as c FROM "+i.storeName,[],function(u,f){var l=f.rows.item(0).c;o(l)},function(u,f){r(f)})})}).catch(r)});return w(n,t),n}function Te(t,e){var n=this,o=new y(function(r,i){n.ready().then(function(){var c=n._dbInfo;c.db.transaction(function(u){X(u,c,"SELECT key FROM "+c.storeName+" WHERE id = ? LIMIT 1",[t+1],function(f,l){var v=l.rows.length?l.rows.item(0).key:null;r(v)},function(f,l){i(l)})})}).catch(i)});return w(o,e),o}function Le(t){var e=this,n=new y(function(o,r){e.ready().then(function(){var i=e._dbInfo;i.db.transaction(function(c){X(c,i,"SELECT key FROM "+i.storeName,[],function(u,f){for(var l=[],v=0;v<f.rows.length;v++)l.push(f.rows.item(v).key);o(l)},function(u,f){r(f)})})}).catch(r)});return w(n,t),n}function Be(t){return new y(function(e,n){t.transaction(function(o){o.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(r,i){for(var c=[],u=0;u<i.rows.length;u++)c.push(i.rows.item(u).name);e({db:t,storeNames:c})},function(r,i){n(i)})},function(o){n(o)})})}function qe(t,e){e=P.apply(this,arguments);var n=this.config();(t=typeof t!="function"&&t||{}).name||(t.name=t.name||n.name,t.storeName=t.storeName||n.storeName);var o,r=this;return w(o=t.name?new y(function(i){var c;c=t.name===n.name?r._dbInfo.db:openDatabase(t.name,"","",0),t.storeName?i({db:c,storeNames:[t.storeName]}):i(Be(c))}).then(function(i){return new y(function(c,u){i.db.transaction(function(f){function l(R){return new y(function(j,B){f.executeSql("DROP TABLE IF EXISTS "+R,[],function(){j()},function(H,wt){B(wt)})})}for(var v=[],g=0,_=i.storeNames.length;g<_;g++)v.push(l(i.storeNames[g]));y.all(v).then(function(){c()}).catch(function(R){u(R)})},function(f){u(f)})})}):y.reject("Invalid arguments"),e),o}var Me={_driver:"webSQLStorage",_initStorage:je,_support:xe(),iterate:Oe,getItem:Ne,setItem:ke,removeItem:Ae,clear:Ce,length:De,key:Te,keys:Le,dropInstance:qe};function Fe(){try{return typeof localStorage!="undefined"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function Xt(t,e){var n=t.name+"/";return t.storeName!==e.storeName&&(n+=t.storeName+"/"),n}function ze(){var t="_localforage_support_test";try{return localStorage.setItem(t,!0),localStorage.removeItem(t),!1}catch{return!0}}function Pe(){return!ze()||localStorage.length>0}function $e(t){var e=this,n={};if(t)for(var o in t)n[o]=t[o];return n.keyPrefix=Xt(t,e._defaultConfig),Pe()?(e._dbInfo=n,n.serializer=yt,y.resolve()):y.reject()}function Ue(t){var e=this,n=e.ready().then(function(){for(var o=e._dbInfo.keyPrefix,r=localStorage.length-1;r>=0;r--){var i=localStorage.key(r);i.indexOf(o)===0&&localStorage.removeItem(i)}});return w(n,t),n}function We(t,e){var n=this;t=k(t);var o=n.ready().then(function(){var r=n._dbInfo,i=localStorage.getItem(r.keyPrefix+t);return i&&(i=r.serializer.deserialize(i)),i});return w(o,e),o}function He(t,e){var n=this,o=n.ready().then(function(){for(var r=n._dbInfo,i=r.keyPrefix,c=i.length,u=localStorage.length,f=1,l=0;l<u;l++){var v=localStorage.key(l);if(v.indexOf(i)===0){var g=localStorage.getItem(v);if(g&&(g=r.serializer.deserialize(g)),(g=t(g,v.substring(c),f++))!==void 0)return g}}});return w(o,e),o}function Ke(t,e){var n=this,o=n.ready().then(function(){var r,i=n._dbInfo;try{r=localStorage.key(t)}catch{r=null}return r&&(r=r.substring(i.keyPrefix.length)),r});return w(o,e),o}function Je(t){var e=this,n=e.ready().then(function(){for(var o=e._dbInfo,r=localStorage.length,i=[],c=0;c<r;c++){var u=localStorage.key(c);u.indexOf(o.keyPrefix)===0&&i.push(u.substring(o.keyPrefix.length))}return i});return w(n,t),n}function Xe(t){var e=this.keys().then(function(n){return n.length});return w(e,t),e}function Qe(t,e){var n=this;t=k(t);var o=n.ready().then(function(){var r=n._dbInfo;localStorage.removeItem(r.keyPrefix+t)});return w(o,e),o}function Ge(t,e,n){var o=this;t=k(t);var r=o.ready().then(function(){e===void 0&&(e=null);var i=e;return new y(function(c,u){var f=o._dbInfo;f.serializer.serialize(e,function(l,v){if(v)u(v);else try{localStorage.setItem(f.keyPrefix+t,l),c(i)}catch(g){g.name!=="QuotaExceededError"&&g.name!=="NS_ERROR_DOM_QUOTA_REACHED"||u(g),u(g)}})})});return w(r,n),r}function Ve(t,e){if(e=P.apply(this,arguments),!(t=typeof t!="function"&&t||{}).name){var n=this.config();t.name=t.name||n.name,t.storeName=t.storeName||n.storeName}var o,r=this;return o=t.name?new y(function(i){t.storeName?i(Xt(t,r._defaultConfig)):i(t.name+"/")}).then(function(i){for(var c=localStorage.length-1;c>=0;c--){var u=localStorage.key(c);u.indexOf(i)===0&&localStorage.removeItem(u)}}):y.reject("Invalid arguments"),w(o,e),o}var Ye={_driver:"localStorageWrapper",_initStorage:$e,_support:Fe(),iterate:He,getItem:We,setItem:Ge,removeItem:Qe,clear:Ue,length:Xe,key:Ke,keys:Je,dropInstance:Ve},Ze=function(t,e){return t===e||typeof t=="number"&&typeof e=="number"&&isNaN(t)&&isNaN(e)},tn=function(t,e){for(var n=t.length,o=0;o<n;){if(Ze(t[o],e))return!0;o++}return!1},Qt=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"},rt={},Gt={},tt={INDEXEDDB:Ie,WEBSQL:Me,LOCALSTORAGE:Ye},en=[tt.INDEXEDDB._driver,tt.WEBSQL._driver,tt.LOCALSTORAGE._driver],st=["dropInstance"],mt=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(st),nn={description:"",driver:en.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function rn(t,e){t[e]=function(){var n=arguments;return t.ready().then(function(){return t[e].apply(t,n)})}}function gt(){for(var t=1;t<arguments.length;t++){var e=arguments[t];if(e)for(var n in e)e.hasOwnProperty(n)&&(Qt(e[n])?arguments[0][n]=e[n].slice():arguments[0][n]=e[n])}return arguments[0]}var on=function(){function t(e){for(var n in I(this,t),tt)if(tt.hasOwnProperty(n)){var o=tt[n],r=o._driver;this[n]=r,rt[r]||this.defineDriver(o)}this._defaultConfig=gt({},nn),this._config=gt({},this._defaultConfig,e),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return t.prototype.config=function(e){if((e===void 0?"undefined":p(e))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var n in e){if(n==="storeName"&&(e[n]=e[n].replace(/\W/g,"_")),n==="version"&&typeof e[n]!="number")return new Error("Database version must be a number.");this._config[n]=e[n]}return!("driver"in e)||!e.driver||this.setDriver(this._config.driver)}return typeof e=="string"?this._config[e]:this._config},t.prototype.defineDriver=function(e,n,o){var r=new y(function(i,c){try{var u=e._driver,f=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void c(f);for(var l=mt.concat("_initStorage"),v=0,g=l.length;v<g;v++){var _=l[v];if((!tn(st,_)||e[_])&&typeof e[_]!="function")return void c(f)}var R=function(){for(var B=function(sn){return function(){var cn=new Error("Method "+sn+" is not implemented by the current driver"),Vt=y.reject(cn);return w(Vt,arguments[arguments.length-1]),Vt}},H=0,wt=st.length;H<wt;H++){var _t=st[H];e[_t]||(e[_t]=B(_t))}};R();var j=function(B){rt[u]&&console.info("Redefining LocalForage driver: "+u),rt[u]=e,Gt[u]=B,i()};"_support"in e?e._support&&typeof e._support=="function"?e._support().then(j,c):j(!!e._support):j(!0)}catch(B){c(B)}});return O(r,n,o),r},t.prototype.driver=function(){return this._driver||null},t.prototype.getDriver=function(e,n,o){var r=rt[e]?y.resolve(rt[e]):y.reject(new Error("Driver not found."));return O(r,n,o),r},t.prototype.getSerializer=function(e){var n=y.resolve(yt);return O(n,e),n},t.prototype.ready=function(e){var n=this,o=n._driverSet.then(function(){return n._ready===null&&(n._ready=n._initDriver()),n._ready});return O(o,e,e),o},t.prototype.setDriver=function(e,n,o){var r=this;Qt(e)||(e=[e]);var i=this._getSupportedDrivers(e);function c(){r._config.driver=r.driver()}function u(v){return r._extend(v),c(),r._ready=r._initStorage(r._config),r._ready}function f(v){return function(){var g=0;function _(){for(;g<v.length;){var R=v[g];return g++,r._dbInfo=null,r._ready=null,r.getDriver(R).then(u).catch(_)}c();var j=new Error("No available storage method found.");return r._driverSet=y.reject(j),r._driverSet}return _()}}var l=this._driverSet!==null?this._driverSet.catch(function(){return y.resolve()}):y.resolve();return this._driverSet=l.then(function(){var v=i[0];return r._dbInfo=null,r._ready=null,r.getDriver(v).then(function(g){r._driver=g._driver,c(),r._wrapLibraryMethodsWithReady(),r._initDriver=f(i)})}).catch(function(){c();var v=new Error("No available storage method found.");return r._driverSet=y.reject(v),r._driverSet}),O(this._driverSet,n,o),this._driverSet},t.prototype.supports=function(e){return!!Gt[e]},t.prototype._extend=function(e){gt(this,e)},t.prototype._getSupportedDrivers=function(e){for(var n=[],o=0,r=e.length;o<r;o++){var i=e[o];this.supports(i)&&n.push(i)}return n},t.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,n=mt.length;e<n;e++)rn(this,mt[e])},t.prototype.createInstance=function(e){return new t(e)},t}(),an=new on;h.exports=an},{3:3}]},{},[4])(4)},Zt(xt={exports:{}},xt.exports),xt.exports);const kt=a=>a.indexOf("csijs_")===0?a:"csijs_"+a,te=(a,s,d)=>{typeof s=="object"&&(s=d?ee(s):(h=>{try{return JSON.stringify(h)}catch{return h}})(ee(s))),((h,m)=>{try{G&&G.setItem(h,m)}catch{}})(kt(a),s)},jt=async(a,s)=>{const d=await(h=>G&&G.getItem?G.getItem(h):null)(kt(a));return d?s?d:(h=>{try{return JSON.parse(h)}catch{return h}})(d):null},hn=a=>{(s=>{try{G&&G.removeItem(s)}catch{}})(kt(a))},ee=a=>{for(const s in a){let d=a[s];if(typeof d!="string")try{d=d.toString()}catch{d=`${d}`}a[s]=d.substr(0,100)}return a},ft=async()=>{const a=await jt("info"),s=[],d=a?a.length:0;if(a&&d){const h=parseInt(a.max,10);for(let m=parseInt(a.min,10);m<=h;m++){const p=`${a.type}_${m}`,I=await jt(p);s.push(I)}}return s},pn=async()=>await G.clear();function St(a){const s=document.createElement("a");return s.className="screenshots",s.innerText=a,s.style.width="120px",s.style.height="40px",s.style.backgroundColor="#0064CD",s.style.color="#fff",s.style.lineHeight="40px",s.style.cursor="pointer",s.style.textAlign="center",s.style.borderRadius="20px",s}function ot(a){const s=document.createElement("td");return s.style.border="1px solid #0064CD",s.style.padding="5px 5px 5px 10px",s.innerHTML=a,s}function $(a,s,d=[]){const h=document.createElement(a);for(const m in s)h.style[m]=s[m];return d.forEach(m=>function(p,I,S){p.setAttribute(I,S)}(h,m.name,m.value)),h}function Q(a,s){this.page=null,this.blackBg=null,this.table=null,this.appended=!1,this.canReport=!0,this.csiReport=a,this.option=s}function ae(a){this.csi=a}Q.prototype.createPage=function(){this.page=this.page||$("div",{zIndex:9999,position:"fixed",top:"0",left:"0",width:"100%",height:"100%"}),this.blackBg=this.blackBg||$("div",{zIndex:0,position:"absolute",width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0.6)"}),this.title=this.title||$("div",{zIndex:2,position:"absolute",width:"400px",left:"50%",top:"30px",fontSize:"26px",color:"#000",textAlign:"center",marginLeft:"-200px"}),this.container=this.container||$("div",{zIndex:1,position:"absolute",width:"1000px",height:"60vh",left:"50%",top:"30px",marginLeft:"-500px"}),this.tableCon=this.tableCon||$("div",{height:"100%",border:"12px solid #0064CD",backgroundColor:"#fff",overflow:"scroll"}),this.table=this.table||$("table",{color:"#333333",width:"100%",borderCollapse:"collapse"},[{name:"id",value:"cyanery-error-table"}]),this.btnCon=this.btnCon||$("div",{margin:"20px auto",width:"400px",display:"flex","flex-direction":"row","justify-content":"space-between",overflow:"hidden"}),this.btn1||(this.btn1=St("\u4E0B\u8F7D")),this.btn2||(this.btn2=St("\u4E0A\u62A5")),this.option.showClear===!1||this.btn3||(this.btn3=St("\u6E05\u7A7A")),this.page.append(this.blackBg),this.page.append(this.container),this.page.append(this.title),this.container.append(this.tableCon),this.tableCon.append(this.table),this.container.append(this.btnCon),this.btnCon.append(this.btn1),this.btnCon.append(this.btn2),this.btn3&&this.btnCon.append(this.btn3),setTimeout(()=>{this.addEventListener()},300)},Q.prototype.addEventListener=function(){this.addEvented||(this.blackBg.addEventListener("click",()=>{this.remove()}),this.btn1.addEventListener("click",a=>{var s="<html><head><meta charset='UTF-8'></head><body>"+document.getElementById("cyanery-error-table").outerHTML+"</body></html>",d=new Blob([s],{type:"application/vnd.ms-excel"}),h=a.target;h.href=URL.createObjectURL(d),h.download="\u9519\u8BEF\u4FE1\u606F\u8868-"+new Date().toLocaleDateString()}),this.btn2.addEventListener("click",async()=>{if(this.canReport){const a=await ft();!Rt(a)&&this.csiReport&&this.csiReport()}else alert("\u5BF9\u4E0D\u8D77\u8BE5\u529F\u80FD\u73B0\u5728\u6CA1\u6709\u652F\u6301\uFF01")}),this.btn3&&this.btn3.addEventListener("click",()=>{pn().then(()=>this.toggleShow())}),this.addEvented=!0)},Q.prototype.fillContent=async function(){const a=await ft();if(Rt(a)){const s=$("div",{width:"100%",position:"absolute",top:"100px",textAlign:"center",fontSize:"24px"});s.innerText="\u6682\u65F6\u6CA1\u6709\u9519\u8BEF\u4FE1\u606F",this.table.append(s)}else for(let s=a.length-1;s>=0;s--){const d=a[s];if(!d)continue;const h=$("tr",{border:"1px solid #0064CD"}),m=ot(ln(d.time)),p=ot(d.etype),I=ot(d.js),S=ot(d.msg);S.style.color="#ff0000";const C=ot(d.ua);h.append(m),h.append(p),h.append(I),h.append(S),h.append(C),this.table.append(h)}},Q.prototype.addTitle=function(){const a=$("tr",{height:"35px",textAlign:"center",backgroundColor:"#ccc"}),s=document.createElement("td");s.append(document.createTextNode("time"));const d=document.createElement("td");d.append(document.createTextNode("type"));const h=document.createElement("td");h.append(document.createTextNode("js"));const m=document.createElement("td");m.append(document.createTextNode("msg"));const p=document.createElement("td");p.append(document.createTextNode("UA")),a.append(s),a.append(d),a.append(h),a.append(m),a.append(p),this.table.append(a)},Q.prototype.appendTo=function(){this.createPage(),this.table.innerHTML="",this.addTitle(),this.fillContent(),this.appended=!0,document.body.append(this.page)},Q.prototype.remove=function(){this.appended=!1,this.page.remove()},Q.prototype.toggleShow=function(){this.appended?this.remove():this.appendTo()},ae.prototype={init(a){const s=new Q(this.csi.report.bind(this.csi),a),d=a.key||6;return document.addEventListener("keydown",h=>{(h=h||window.event).ctrlKey&&parseInt(h.key,10)===d&&s.toggleShow()}),s.toggleShow.bind(s)}};const se=function(a){this.forms=a};se.prototype.probe=function(){const{onerror:a}=window;window.onerror=(...s)=>{var d,h,m,p;typeof a=="function"&&a.apply(this,s),d=this.forms,h=s[0],m=s[1],p=s[2],d.addLine("ERROR",{etype:"win error",msg:h,js:`${m} : ${p}`})}};const ne=[],Nt=function(a){this.forms=a};Nt.prototype.probe=function(){const a=this,{open:s}=XMLHttpRequest.prototype;XMLHttpRequest.prototype.open=function(){a.addListener(this,arguments),s.apply(this,arguments)}},Nt.prototype.addListener=function(a,s){if(ne.indexOf(a)>=0)return;ne.push(a);const{onloadend:d}=a,{ontimeout:h}=a;a.onloadend=(...m)=>{const p=`${a.status}`;/^2[0-9]{1,3}/gi.test(p)||p==="0"||(this.forms.addLine("ERROR",{etype:"ajax error",msg:`status:${a.status}`,js:s.join(" :")}),d&&d.apply(this,m))},a.ontimeout=(...m)=>{this.forms.addLine("ERROR",{etype:"ajax error",msg:`timeout ${a.status}`,js:s.join(" :")}),h&&h.apply(this,m)}};const ce=function(a){this.forms=a};ce.prototype.probe=function(){if(!window.fetch)return;const a=window.fetch;window.fetch=(s,d)=>{let h="GET",m=s||"";return typeof s=="string"?h=d&&d.method?d.method:h:Object.prototype.toString.call(s)==="[object Request]"&&(h=s.method||h,m=s.url||""),a(s,d).then(p=>{const I=`${p.status}`;return/^2[0-9]{1,3}/gi.test(I)||+I==0||this.forms.addLine("ERROR",{etype:"fetch error",msg:`status:${p.status}`,js:`${h} :${m}`}),p}).catch(p=>{let I;try{I=p&&p.message?p.message:JSON.stringify(p)}catch{I=p&&p.message?p.message:p}throw this.forms.addLine("ERROR",{etype:"fetch error",msg:I,js:`${h} :${m}`}),p})}};const vn=function(){this.fid="",this.uid="",this.min=0,this.max=0,this.type="",this.length=""},bn=function(){this.pid="",this.index="",this.time="",this.ua="",this.etype="",this.msg="",this.url="",this.other=""},Ot=function(a,s,d){this.update=d;const h={feid:a,uid:ie(),min:0,max:0,type:s,length:0};jt("info").then(m=>{this.info=oe(new vn,h,m),this.line=new bn})};Ot.prototype={addLine(a){const s={pid:ie(6),index:parseInt(this.info.max,10)+1,time:Date.now(),ua:re()};(h=>{for(const m in h)h[m]=""})(this.line),oe(this.line,s,a);const d=`${this.info.type}_${this.line.index}`;te(d,this.line),this.updateInfo(this.line)},updateInfo(a){const s=parseInt(a.index,10);let d=parseInt(this.info.min,10);d=d||s;let h=s-d+1;if(h>45){const m=h-45;for(let p=0;p<m;p++){const I=`${this.info.type}_${d+p}`;hn(I)}h=45}if(this.info.length=h,this.info.min=s-h+1,this.info.max=s,te("info",this.info),this.update instanceof Function){const m=this;setTimeout(function(){ft().then(p=>{m.update(a,p)})},100)}}};const ue=function(a,s){this.norTable=new Ot(a,"nor",s),this.errTable=new Ot(a,"err",s)};ue.prototype={addLine(a,s){const d=a==="err"||a==="error"||a==="ERROR"?this.errTable:this.norTable;setTimeout(()=>{d.addLine(s)},0)}};const Et=()=>{re();const{browser:a}=Y,{name:s}=a,d=parseFloat(a.version);return s==="ie"&&d<9};class yn{constructor(s={}){this.inited=!1,this.toggleShow=()=>{},this.checkParams(s),this.init(s)}checkParams(s){if(!s.feID)throw Error("feID\u5FC5\u4F20");if(!s.report||typeof s.report!="function")throw Error("\u8BF7\u586B\u5199\u81EA\u5B9A\u4E49\u4E0A\u62A5\u51FD\u6570")}init(s){if(!this.inited&&!Et())try{this.opts=s;const d=new ue(s.feID,s.onUpdate);this.toggleShow=new ae(this).init(s),new se(d).probe(),new Nt(d).probe(),new ce(d).probe(),this.inited=!0}catch(d){}}probe(s){Et()||this.forms.addLine("ERROR",{etype:"custom error",msg:s})}async report(){if(Et())return;const s=await ft();Rt(s)||this.opts.report(s)}}export{yn as M};
